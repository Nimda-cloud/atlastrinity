# Mistral Vibe Configuration (Native Format)
# Official documentation: https://docs.mistral.ai/mistral-vibe/introduction/configuration

# Active model for Vibe (Copilot/GPT-4o is now the default)
active_model = "gpt-4o"
fallback_chain = ["gpt-4o", "devstral-2", "devstral-openrouter"]

# System prompt ID (refers to file in ~/.vibe/prompts/ cli.md by default)
system_prompt_id = "cli"

# Default operational mode (default, plan, accept-edits, auto-approve)
default_mode = "auto-approve"

# Enable/Disable auto-updates
enable_auto_update = true

# Execution limits
max_turns = 100

# =============================================================================
# Tool Availability Patterns
# =============================================================================
# Exact names, glob patterns, or re: prefix for regex
enabled_tools = [] # Empty = all enabled
disabled_tools = [] # No tools disabled

# =============================================================================
# Provider Configuration
# =============================================================================
[[providers]]
name = "mistral"
api_base = "https://api.mistral.ai/v1"
api_key_env_var = "MISTRAL_API_KEY"
api_style = "mistral"
backend = "mistral"

[[providers]]
name = "openrouter"
api_base = "https://openrouter.ai/api/v1"
api_key_env_var = "OPENROUTER_API_KEY"
api_style = "openai"
backend = "generic"

[[providers]]
name = "copilot"
api_base = "http://127.0.0.1:8085"
api_key_env_var = "COPILOT_SESSION_TOKEN"
api_style = "openai"
backend = "generic"
requires_proxy = true
proxy_command = "python3 ${PROJECT_ROOT}/scripts/copilot_proxy.py"
requires_token_exchange = true

# =============================================================================
# Model Presets
# =============================================================================
[[models]]
name = "gpt-4o"
provider = "copilot"
alias = "gpt-4o"
temperature = 0.1
input_price = 0.0
output_price = 0.0

[[models]]
name = "devstral-2512"
provider = "mistral"
alias = "devstral-2"
temperature = 0.0
input_price = 0.0
output_price = 0.0

[[models]]
name = "mistralai/devstral-2512:free"
provider = "openrouter"
alias = "devstral-openrouter"
temperature = 0.2
input_price = 0.0
output_price = 0.0

# =============================================================================
# Built-in Tool Permissions
# =============================================================================
[tools.bash]
permission = "always"

[tools.write_file]
permission = "always"

[tools.read_file]
permission = "always"

[tools.grep]
permission = "always"

[tools.search_replace]
permission = "always"

# =============================================================================
# MCP Server Configuration (Optional)
# =============================================================================
# You can add [[mcp_servers]] here to extend Vibe's capabilities.

[[mcp_servers]]
name = "devtools"
transport = "stdio"
command = "python3"
args = ["-m", "src.mcp_server.devtools_server"]
env = { PYTHONPATH = "${PROJECT_ROOT}" }
description = "Developer Tools (Linter, Analysis, MCP Inspector CLI & Sandbox)"

# NOTE: Minimal MCP list by default to maximize TPM (Anti-Rate Limit).
