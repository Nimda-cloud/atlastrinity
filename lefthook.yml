# Lefthook configuration for modernized local CI
# Run all linters: npx lefthook run lint:all

lint:all:
  parallel: true
  commands:
    01-biome:
      run: npx @biomejs/biome check --write src scripts
    02-ruff:
      run: .venv/bin/ruff check . --fix && .venv/bin/ruff format .
    03-pyright:
      run: npx pyright src scripts
    04-pyrefly:
      run: .venv/bin/python -m pyrefly check src/
    05-complexity:
      run: .venv/bin/xenon --max-absolute D --max-modules C --max-average B src
    06-bandit:
      run: .venv/bin/bandit -c pyproject.toml -r src
    07-knip:
      run: npx knip
    08-security:
      run: npm run lint:security
    09-yaml-sync:
      run: .venv/bin/python scripts/sync_and_validate_configs.py
    10-oxlint:
      run: npx oxlint src scripts --deny-warnings --fix

pre-commit:
  parallel: false
  commands:
    diagrams:
      run: npm run diagram:auto-update && git add src/brain/data/architecture_diagrams/mcp_architecture.md .agent/docs/mcp_architecture_diagram.md

pre-push:
  parallel: true
  commands:
    checks:
      run: npx lefthook run lint:all
